{"ast":null,"code":"import _createForOfIteratorHelper from\"/Users/sumanthvarma/Desktop/frontend/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js\";import _regeneratorRuntime from\"/Users/sumanthvarma/Desktop/frontend/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/sumanthvarma/Desktop/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _classCallCheck from\"/Users/sumanthvarma/Desktop/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/Users/sumanthvarma/Desktop/frontend/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _inherits from\"/Users/sumanthvarma/Desktop/frontend/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/Users/sumanthvarma/Desktop/frontend/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React from'react';import{connect}from'react-redux';import{createSelector}from'reselect';import*as selectors from'../../../Reducers/selectors';import Button from'react-bootstrap/Button';import AutoCompleteBar from\"../../AutoCompleteBar\";import{geocodeByAddress,getLatLng}from'react-places-autocomplete';import{getListingByPlaceId}from'../../../Requests/listings-requests';import PulseLoader from\"../../UI/PulseLoader\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var SelectLocation=/*#__PURE__*/function(_React$Component){_inherits(SelectLocation,_React$Component);var _super=_createSuper(SelectLocation);function SelectLocation(props){var _this;_classCallCheck(this,SelectLocation);_this=_super.call(this,props);_this.handleSubmit=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_this.props.setLocation(_this.state.address);case 1:case\"end\":return _context.stop();}}},_callee);}));_this.selectAddress=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(address){var error,zip,number,street,city,state,place,geoCode,list_check,addressState;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_this.setState({error:false,loading:true});error=false;state='';_context2.next=5;return geocodeByAddress(address).then(function(results){var _iterator=_createForOfIteratorHelper(results[0].address_components),_step;try{for(_iterator.s();!(_step=_iterator.n()).done;){var c=_step.value;var _iterator2=_createForOfIteratorHelper(c.types),_step2;try{for(_iterator2.s();!(_step2=_iterator2.n()).done;){var type=_step2.value;if(type=='street_number')number=c.long_name;else if(type=='route')street=c.short_name;else if(type=='locality')city=c.long_name;else if(type=='administrative_area_level_1')state=c.short_name;else if(type==\"postal_code\")zip=c.long_name;}}catch(err){_iterator2.e(err);}finally{_iterator2.f();}}// improper address\n}catch(err){_iterator.e(err);}finally{_iterator.f();}if(number==undefined){_this.setState({error:true,errorMessage:\"Sorry, this address is too general. Please try again\",loading:false});error=true;return;}place=results[0];return getLatLng(results[0]);}).then(function(latLng){return latLng;}).catch(function(error){return console.error('Error',error);});case 5:geoCode=_context2.sent;if(!(place!=undefined)){_context2.next=14;break;}_context2.next=9;return getListingByPlaceId(place.place_id,true);case 9:list_check=_context2.sent;if(!(list_check.length>0)){_context2.next=14;break;}_this.setState({error:true,errorMessage:\"Sorry, this location already has a listing.\",loading:false});error=true;return _context2.abrupt(\"return\");case 14:addressState={};addressState.formatted=address;addressState.street=number+' '+street;addressState.city=city;addressState.state=state;addressState.zip=zip;addressState.coords=geoCode;addressState.place=place;if(!error){_context2.next=24;break;}return _context2.abrupt(\"return\");case 24:_this.setState({address:addressState,loading:false});case 25:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x){return _ref2.apply(this,arguments);};}();_this.state={error:false,errorMessage:'',loading:false};return _this;}_createClass(SelectLocation,[{key:\"render\",value:function render(){return/*#__PURE__*/_jsxs(\"div\",{className:\"selectLocationPage\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"selectLocationHeader\",children:[/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"h2\",{children:\"Select Location\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"p\",{children:\"Begin typing in the address of your desired location and select it from the dropdown menu to get started \"})]}),this.state.error&&/*#__PURE__*/_jsx(\"p\",{style:{color:'red',marginTop:10},children:this.state.errorMessage}),/*#__PURE__*/_jsxs(\"div\",{className:\"listingSearchBar\",children:[/*#__PURE__*/_jsx(AutoCompleteBar,{addressFunction:this.selectAddress,position:\"relative\",font:true}),/*#__PURE__*/_jsx(\"br\",{}),this.state.loading&&/*#__PURE__*/_jsx(PulseLoader,{color:\"#00D4FF\",size:10}),!this.state.loading&&/*#__PURE__*/_jsx(Button,{variant:\"primary\",onClick:this.handleSubmit,disabled:this.state.address==undefined||this.state.error,style:{backgroundColor:'#00d4ff',fontWeight:'bold',alignSelf:'center',zIndex:-100000},children:\"Submit\"})]})]});}}]);return SelectLocation;}(React.Component);var mapStateToProps=createSelector(selectors.addressSelector,selectors.userSelector,function(address,user){return{address:address,user:user};});export default connect(mapStateToProps)(SelectLocation);","map":{"version":3,"names":["React","connect","createSelector","selectors","Button","AutoCompleteBar","geocodeByAddress","getLatLng","getListingByPlaceId","PulseLoader","SelectLocation","props","handleSubmit","setLocation","state","address","selectAddress","setState","error","loading","then","results","address_components","c","types","type","number","long_name","street","short_name","city","zip","undefined","errorMessage","place","latLng","catch","console","geoCode","place_id","list_check","length","addressState","formatted","coords","color","marginTop","backgroundColor","fontWeight","alignSelf","zIndex","Component","mapStateToProps","addressSelector","userSelector","user"],"sources":["/Users/sumanthvarma/Desktop/frontend/src/Components/Listings/AddListing/SelectLocation.js"],"sourcesContent":["import React  from 'react'\nimport { connect } from 'react-redux'\nimport { createSelector } from 'reselect';\nimport * as selectors from '../../../Reducers/selectors'\nimport Button from 'react-bootstrap/Button'\nimport AutoCompleteBar from \"../../AutoCompleteBar\"\nimport { geocodeByAddress, getLatLng } from 'react-places-autocomplete';\nimport { getListingByPlaceId } from '../../../Requests/listings-requests'\nimport PulseLoader from \"../../UI/PulseLoader\"\n\nclass SelectLocation extends React.Component {\n\n    constructor(props) {\n        super(props)\n       \n        this.state = {\n            error : false,\n            errorMessage : '',\n            loading : false\n        }\n    }\n\n    handleSubmit = async () => {\n        this.props.setLocation(this.state.address)\n    }\n\n    selectAddress = async (address) => {\n        this.setState({ error : false, loading: true  })\n        let error = false\n        let zip, number, street, city, state = ''\n        let place;\n        let geoCode = await geocodeByAddress(address).then(results => { \n                for (let c of results[0].address_components) {\n                    for (let type of c.types) {\n                        if (type == 'street_number')\n                            number = c.long_name \n                        else if (type == 'route')\n                            street =  c.short_name \n                        else if (type == 'locality')\n                            city = c.long_name\n                        else if (type == 'administrative_area_level_1')\n                            state = c.short_name\n                        else if (type == \"postal_code\") \n                            zip = c.long_name\n                    }\n                }\n                // improper address\n                if (number == undefined) {\n                    this.setState({ error : true, errorMessage : \"Sorry, this address is too general. Please try again\", loading : false })\n                    error = true \n                    return;\n                }  \n                place = results[0]\n                return getLatLng(results[0])\n            })\n            .then(latLng => latLng)\n            .catch(error => console.error('Error', error));\n\n            if (place != undefined) {\n                // check if listing already exists\n                let list_check = await getListingByPlaceId(place.place_id, true)\n\n                if (list_check.length > 0) {\n                    this.setState({ error : true, errorMessage : \"Sorry, this location already has a listing.\", loading: false })\n                    error = true \n                    return;\n                }\n            }\n\n            let addressState = {}\n            addressState.formatted = address\n            addressState.street = number + ' ' + street\n           \n            addressState.city = city\n            addressState.state = state\n            addressState.zip = zip\n            addressState.coords = geoCode\n            addressState.place = place\n\n\n            if (error) return;\n            \n            this.setState({ address : addressState, loading : false })\n    }\n\n\n    render() {\n        return (\n            <div className=\"selectLocationPage\">\n                <div className=\"selectLocationHeader\">\n                    <br></br>\n                    <h2>Select Location</h2>\n                    <br></br>\n                    <p>Begin typing in the address of your desired location and select it from the dropdown menu to get started </p>\n                </div>\n                    {this.state.error && <p style={{ color: 'red', marginTop: 10}}>{this.state.errorMessage}</p>}\n                    <div className=\"listingSearchBar\">\n                    <AutoCompleteBar addressFunction={this.selectAddress} position=\"relative\" font/>\n                    <br></br>\n                    {this.state.loading &&  <PulseLoader color='#00D4FF' size={10}/>}\n                    {!this.state.loading && <Button variant=\"primary\" onClick={this.handleSubmit} disabled={this.state.address == undefined || this.state.error}\n                        style={{backgroundColor:'#00d4ff', fontWeight: 'bold', alignSelf: 'center', zIndex: -100000 }}>\n                        Submit\n                    </Button>\n                    }\n                </div>\n            </div>\n        )\n    }\n }\n\n \n const mapStateToProps = createSelector(\n     selectors.addressSelector,\n     selectors.userSelector,\n    (address, user) => ({\n        address, user \n    })\n )\n\n\n export default connect(mapStateToProps)(SelectLocation)"],"mappings":"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"},"metadata":{},"sourceType":"module"}